<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Web-Ported - WebGL ports</title>

<style>
:root{
  --bg: #000000;
  --text: #ffffff;
  --accent: #ff3b3b;
  --muted: #bdbdbd;
}

*{ box-sizing: border-box; }
html, body{ height:100%; margin:0; padding:0; }

body{
  font-family: Inter, system-ui, sans-serif;
  color: var(--text);
  display:flex;
  flex-direction:column;
  min-height:100vh;
  background-image: url("background.png");
  background-repeat: no-repeat;
  background-size: cover;
  background-position: center 0%;
  background-color: black;
}

/* HEADER + FOOTER glow */
header, footer {
  text-shadow: 0 0 6px rgba(255,255,255,0.55);
}

/* Header layout preserved from old version */
header{
  padding:1rem;
  border-bottom:1px solid rgba(255,255,255,0.12);
  display:flex;
  align-items:center;
  justify-content:space-between;
  position:relative;
  z-index:20;
}

.brand img{
  height:40px;
  width:auto;
  display:block;
  user-select:none;
}

nav a{
  text-decoration:none;
  color:var(--muted);
  margin-left:1rem;
  font-size:0.95rem;
}

/* GRID stays from old version */
main{
  flex:1;
  padding:1.25rem;
  max-width:1000px;
  width:100%;
  margin:0 auto;
  z-index:5;
}

#portContainer{
  margin-top:1.25rem;
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(240px, 1fr));
  gap:1rem;
}

/* -----------------------------
   GLASS CARD (NEW)
----------------------------- */
.port-card{
  border:1px solid rgba(255,255,255,0.12);
  padding:1rem;
  border-radius:12px;
  backdrop-filter: blur(12px) saturate(120%);
  -webkit-backdrop-filter: blur(12px) saturate(120%);
  background: rgba(0,0,0,0.32);
  margin-bottom:1rem;
  color:var(--text);
  transition:
    transform .28s cubic-bezier(.25,.9,.3,1.08),
    background .22s ease,
    box-shadow .28s ease;
}

/* Hover GLOW (NEW) */
.port-card-link:hover .port-card{
  transform: scale(1.1);
  background: rgba(0,0,0,0.40);
  box-shadow: 0 0 22px rgba(255,255,255,0.12);
}

/* Image smaller (new) */
.port-card img{
  width:100%;
  height:150px;
  object-fit:cover;
  border-radius:8px;
  margin-bottom:0.5rem;
}

/* Title hover color only */
.port-card h2{
  text-align:center;
  margin:0;
  padding:0.35rem 0 0;
  font-size:1.05rem;
  transition: color .16s ease;
}
.port-card h2:hover{
  color: var(--accent);
}

/* Anchor block */
.port-card-link{
  text-decoration:none;
  color:var(--text);
  display:block;
}

/* Disable old scale-on-title-hover */
.port-card.title-hover{
  transform:none !important;
}

/* Small screen behavior (old) */
@media (max-width:600px){
  nav{ display:none; }
  main{ padding:1rem; }
  #portContainer{ grid-template-columns:1fr; }
}

/* -----------------------------
   DASHBOARD (use new glass)
----------------------------- */
.dashboard-btn{
  background:none;
  border:1px solid rgba(255,255,255,0.9);
  padding:0.45rem;
  width:42px;
  height:42px;
  border-radius:6px;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
}
.dash-icon{
  width:22px;
  height:16px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
}
.dash-icon div{
  height:2.75px;
  background:white;
  border-radius:2px;
}

/* NEW glass panel */
.dashboard-panel{
  position:absolute;
  right:1rem;
  top:65px;
  width:220px;
  padding:0.6rem;
  border-radius:8px;
  background:rgba(0,0,0,0.38);
  backdrop-filter:blur(12px);
  border:1px solid rgba(255,255,255,0.12);
  transform: translateY(-8px);
  opacity:0;
  pointer-events:none;
  transition:
    opacity .22s ease,
    transform .22s cubic-bezier(.2,.9,.3,1);
}

.dashboard-panel.open{
  opacity:1;
  transform:translateY(0);
  pointer-events:auto;
}

.dashboard-panel a{
  display:block;
  padding:0.45rem 0.6rem;
  text-decoration:none;
  color:var(--text);
  border-radius:6px;
  font-size:0.95rem;
}
.dashboard-panel a:hover{
  background:rgba(255,255,255,0.12);
  color:var(--accent);
}

/* -----------------------------
   FOOTER (new)
----------------------------- */
footer{
  text-align:center;
  padding:1rem;
}
footer a{
  color:white;
  text-shadow:0 0 6px rgba(255,255,255,0.6);
  margin:0 10px;
  text-decoration:none;
  font-size:0.95rem;
}
footer a:hover{
  color:var(--accent);
}
</style>
</head>
<body>

<header>
  <div class="brand">
    <img src="webgL.png" alt="Site Logo">
  </div>

  <nav>
    <a href="#">Home</a>
    <a href="#">About</a>
    <a href="#">Contact</a>
  </nav>

  <button id="dashBtn" class="dashboard-btn" aria-controls="dashPanel" aria-expanded="false">
    <span class="dash-icon">
      <div></div><div></div><div></div>
    </span>
  </button>
</header>

<div id="dashPanel" class="dashboard-panel" role="menu">
  <a href="#">Settings</a>
  <a href="#">Account</a>
  <a href="#">Tools</a>
  <a href="#">Dev Options</a>
</div>

<main>
  <section class="card">
    <h1>Welcome to Web-Ported!</h1>
    <p>webports downloaded from gn-math, credits to genizy &lt;3</p>
  </section>

  <div id="portContainer" aria-live="polite"></div>
</main>

<footer>
  <a href="#">version: v0.1</a><br>
  <a href="#">discord</a><br>
  <a href="#">suggestions & bug fixes</a><br>
  <a href="#">other projects</a><br>
  Â© <span id="year"></span>
</footer>

<script>
(function () {

  /* YEAR */
  const yearEl = document.getElementById('year');
  if (yearEl) yearEl.textContent = new Date().getFullYear();

  /* DASHBOARD logic (old) */
  const dashBtn = document.getElementById('dashBtn');
  const dashPanel = document.getElementById('dashPanel');

  function openPanel(){
    dashPanel.classList.add('open');
    dashBtn.setAttribute('aria-expanded','true');
  }
  function closePanel(){
    dashPanel.classList.remove('open');
    dashBtn.setAttribute('aria-expanded','false');
  }
  function togglePanel(){
    dashPanel.classList.contains('open') ? closePanel() : openPanel();
  }

  dashBtn.addEventListener('click', e => {
    e.stopPropagation();
    togglePanel();
  });

  document.addEventListener('click', e => {
    if (!dashPanel.contains(e.target) && !dashBtn.contains(e.target)){
      closePanel();
    }
  });

  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') closePanel();
  });

  /* BACKGROUND SCROLL (old) */
  function updateBackgroundScroll(){
    try{
      const scrollTop = window.scrollY || 0;
      const docHeight = Math.max(document.body.scrollHeight - window.innerHeight, 0);
      let scrollPercent = docHeight > 0 ? (scrollTop / docHeight) : 0;

      const slowFactor = 0.22;
      let mapped = Math.min(Math.max(scrollPercent * slowFactor, 0), slowFactor);

      document.body.style.backgroundPosition = 'center ' + (mapped * 100) + '%';
    }catch(err){
      console.error(err);
    }
  }
  window.addEventListener('scroll', updateBackgroundScroll, { passive:true });
  window.addEventListener('resize', updateBackgroundScroll);
  updateBackgroundScroll();

  /* PORT LOADER (old) */
  const portContainer = document.getElementById('portContainer');

  function makeCard(item){
    const a = document.createElement('a');
    a.className = 'port-card-link';
    a.href = item.link?.trim() || '#';
    if (item.link) a.target = '_blank';
    a.rel = 'noopener noreferrer';

    const card = document.createElement('div');
    card.className = 'port-card';

    const img = document.createElement('img');
    img.src = item.image || 'icon.png';
    img.alt = item.title || 'item';
    img.loading = 'lazy';

    const h2 = document.createElement('h2');
    h2.textContent = item.title || '';

    h2.addEventListener('mouseenter', () => card.classList.add('title-hover'));
    h2.addEventListener('mouseleave', () => card.classList.remove('title-hover'));

    card.append(img, h2);
    a.append(card);
    return a;
  }

  fetch('ports.json',{cache:'no-store'})
    .then(res => res.json())
    .then(data => {
      portContainer.innerHTML = '';
      data.forEach(item => portContainer.appendChild(makeCard(item)));
    })
    .catch(() => {
      portContainer.innerHTML = `
      <div class="card">
        <strong>Could not load ports.json</strong>
        <p>Place a ports.json file in the site root.</p>
      </div>`;
    });

})();
</script>

</body>
</html>
